#!/bin/bash

CLIENT_JAR=foundationdb-sql-layer-client-tools-1.3.7-SNAPSHOT.jar
BASEDIR="$(dirname "$0")"

if [ -f "${BASEDIR}/../pom.xml" ]; then
    # Developer running bin/fdbsqldump from working dir: use just built / copied.
    CDIR="${BASEDIR}/../target"
    JDIR="${BASEDIR}/../target/dependency"
elif [ -f "${BASEDIR}/../lib/${CLIENT_JAR}" ]; then
    # Installed outside FHS: assume from bin and jars are in lib.
    CDIR="${BASEDIR}/../lib"
    JDIR="$CDIR/client"
else
    # Package installation: hopefully in official places.
    CLIENT_JAR=foundationdb-sql-layer-client-tools.jar
    CDIR=/usr/share/foundationdb-sql
    JDIR=$CDIR/client
fi

[ -r "${CDIR}/${CLIENT_JAR}" ] || { echo "$0: Error: Couldn't find ${CDIR}/${CLIENT_JAR}"; exit 1; }

CLASSPATH="${CDIR}/${CLIENT_JAR}:${JDIR}/*"
java -cp "${CLASSPATH}" com.foundationdb.sql.client.dump.DumpClient "$@"
